
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://github.com/Bundabrg/GeyserLink/custommessages/" rel="canonical"/>
<meta content="Bundabrg" name="author"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-5.1.3" name="generator"/>
<title>Custom Messages - GeyserLink</title>
<link href="../assets/stylesheets/main.62d34fff.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.c8acc6db.min.css" rel="stylesheet"/>
<meta content="#3f51b5" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="../css/mkdocs.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#custom-message-and-response">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="GeyserLink" class="md-header-nav__button md-logo" href="https://github.com/Bundabrg/GeyserLink" title="GeyserLink">
<img alt="logo" src="../img/header_logo.png"/>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            GeyserLink
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Custom Messages
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/Bundabrg/GeyserLink" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Bundabrg/GeyserLink
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="GeyserLink" class="md-nav__button md-logo" href="https://github.com/Bundabrg/GeyserLink" title="GeyserLink">
<img alt="logo" src="../img/header_logo.png"/>
</a>
    GeyserLink
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/Bundabrg/GeyserLink" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    Bundabrg/GeyserLink
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../quickstart/" title="QuickStart">
      QuickStart
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../howitworks/" title="How it works">
      How it works
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Custom Messages
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Custom Messages">
      Custom Messages
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-message-and-response">
    Custom Message and Response
  </a>
<nav aria-label="Custom Message and Response" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#playerquerymessage">
    PlayerQueryMessage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#playerqueryresponse">
    PlayerQueryResponse
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#putting-it-together">
    Putting it together
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#message-event">
    Message Event
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#security">
    Security
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../contributing/" title="Contributing">
      Contributing
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-message-and-response">
    Custom Message and Response
  </a>
<nav aria-label="Custom Message and Response" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#playerquerymessage">
    PlayerQueryMessage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#playerqueryresponse">
    PlayerQueryResponse
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#putting-it-together">
    Putting it together
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#message-event">
    Message Event
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#security">
    Security
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset"><a class="md-content__icon pdf-download-btn" download href="../pdf/documentation.pdf" title="Download"><i class="fa fas fa-download"></i><small> PDF</small></a>
<h1>Custom Messages</h1>
<p>Whilst we can send raw messages using GeyserLink it is easier to define a Message and Response class that will serialize and
unserialize the responses.</p>
<h2 id="custom-message-and-response">Custom Message and Response<a class="headerlink" href="#custom-message-and-response" title="Permanent link">¶</a></h2>
<p>Let's create a <code>PlayerQueryMessage</code> and <code>PlayerQueryResponse</code> that returns the number of players on the server. It is up 
to you as to which server will respond to this but for this example we will assume the GeyserLink plugin is on a Spigot server 
and on a Geyser proxy and that either side may send the message to get a response from the other side. </p>
<h3 id="playerquerymessage">PlayerQueryMessage<a class="headerlink" href="#playerquerymessage" title="Permanent link">¶</a></h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PlayerQueryMessage</span> <span class="kd">extends</span> <span class="n">WrappedMessage</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">channel</span> <span class="o">=</span> <span class="s">"myPlugin:command"</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">subChannel</span> <span class="o">=</span> <span class="s">"player-query"</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">PlayerQueryMessage</span><span class="p">(</span><span class="n">String</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">PlayerQueryMessage</span><span class="p">(</span><span class="n">JsonNode</span> <span class="n">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">ObjectNode</span> <span class="nf">serialize</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kd">super</span><span class="p">.</span><span class="na">serialize</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>Here we define the channel and subchannel that this message will use. The rest is mainly boilerplate dealing with
serializing or deserializing the object.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Messages make use of JSON to contain their structure in a packet. This means that when serializing an object
 it will call the <code>serialize</code> method that will add to an ObjectNode any data relevant for the object.</p>
<p>To deserialize a constructor taking a <code>JsonNode</code> is used which then pulls from that any relevant fields for
 the object.</p>
</div>
<h3 id="playerqueryresponse">PlayerQueryResponse<a class="headerlink" href="#playerqueryresponse" title="Permanent link">¶</a></h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PlayerQueryResponse</span> <span class="kd">extends</span> <span class="n">WrappedResponse</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">PlayerQueryResponse</span><span class="p">(</span><span class="kt">int</span> <span class="n">count</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">();</span>

        <span class="k">this</span><span class="p">.</span><span class="na">count</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">PlayerQueryResponse</span><span class="p">(</span><span class="n">JsonNode</span> <span class="n">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">count</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">"count"</span><span class="p">).</span><span class="na">asInt</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">ObjectNode</span> <span class="nf">serialize</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kd">super</span><span class="p">.</span><span class="na">serialize</span><span class="p">()</span>
                <span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>This one is a bit more interesting as it has a data field <code>count</code>. We have to deal with how to deserialize from a JsonNode
and how to serialize to an ObjectNode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the Response does not need to define a channel or subchannel.</p>
</div>
<h3 id="putting-it-together">Putting it together<a class="headerlink" href="#putting-it-together" title="Permanent link">¶</a></h3>
<p>Now you can send a PlayerQueryMessage by doing something like this:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">GeyserLink</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">sendMessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="k">new</span> <span class="n">PlayerQueryMessage</span><span class="p">())</span>
    <span class="p">.</span><span class="na">onResponse</span><span class="p">(</span><span class="n">PlayerQueryResponse</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">signed</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="n">getLogger</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">"The server has %d players on it"</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="na">getCount</span><span class="p">()));</span>
    <span class="p">});</span>
</code></pre></div>
</div>
<h2 id="message-event">Message Event<a class="headerlink" href="#message-event" title="Permanent link">¶</a></h2>
<p>Whichever server is responding to the message will need to register an event listener for the message. The following is a
simple example for a Spigot server.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="nd">@EventHandler</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onGeyserLinkMessage</span><span class="p">(</span><span class="n">GeyserLinkMessageEvent</span> <span class="n">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">getMessage</span><span class="p">().</span><span class="na">getChannel</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="s">"myPlugin:command"</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">switch</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">getMessage</span><span class="p">().</span><span class="na">getSubChannel</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s">"player-query"</span><span class="p">:</span>
            <span class="n">GeyserLink</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">sendResponse</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="na">getPlayer</span><span class="p">(),</span> <span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">getMessage</span><span class="p">(),</span>
                    <span class="k">new</span> <span class="n">PlayerQueryResponse</span><span class="p">(</span><span class="n">plugin</span><span class="p">.</span><span class="na">getServer</span><span class="p">().</span><span class="na">getOnlinePlayers</span><span class="p">().</span><span class="na">size</span><span class="p">()));</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="security">Security<a class="headerlink" href="#security" title="Permanent link">¶</a></h2>
<p>You may have noticed an issue with the previous example.  Anyone could connect to a server and either spoof GeyserLink
messages or run their own GeyserLink plugin on a proxy and thus the player count must come from a trusted partner. We also
don't want a random person being able to query the player count.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If possible try support untrusted clients as well. If the player count in this example is not confidential then there may be
no reason not to still allow queries. Also if the message is coming from a client side mod then it will be untrusted
by default.</p>
</div>
<p>To solve this we need to check on both sides. On the client side the following would only accept trusted responses:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">GeyserLink</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">sendMessage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="k">new</span> <span class="n">PlayerQueryMessage</span><span class="p">())</span>
    <span class="p">.</span><span class="na">onResponse</span><span class="p">(</span><span class="n">PlayerQueryResponse</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">signed</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">signed</span><span class="p">.</span><span class="na">isTrusted</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">getLogger</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">"The server has %d players on it"</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="na">getCount</span><span class="p">()));</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre></div>
</div>
<p>The server could be updated as follows:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="nd">@EventHandler</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onGeyserLinkMessage</span><span class="p">(</span><span class="n">GeyserLinkMessageEvent</span> <span class="n">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">getMessage</span><span class="p">().</span><span class="na">getChannel</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="s">"myPlugin:command"</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">switch</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">getMessage</span><span class="p">().</span><span class="na">getSubChannel</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s">"player-query"</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">isTrusted</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">GeyserLink</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">sendResponse</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="na">getPlayer</span><span class="p">(),</span> <span class="n">event</span><span class="p">.</span><span class="na">getSignedMessage</span><span class="p">().</span><span class="na">getMessage</span><span class="p">(),</span>
                        <span class="k">new</span> <span class="n">PlayerQueryResponse</span><span class="p">(</span><span class="n">plugin</span><span class="p">.</span><span class="na">getServer</span><span class="p">().</span><span class="na">getOnlinePlayers</span><span class="p">().</span><span class="na">size</span><span class="p">()));</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<hr/>
<div class="md-source-date">
<small>
    
      Last update: <span class="timeago" datetime="1592900882000" locale="en"></span>
</small>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../howitworks/" rel="prev" title="How it works">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                How it works
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../contributing/" rel="next" title="Contributing">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Contributing
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright (C) 2020 GeyserLink Developers
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/vendor.f81b9e8b.min.js"></script>
<script src="../assets/javascripts/bundle.23546af0.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "..",
          features: ["instant"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.0-beta.2/timeago.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.0-beta.2/timeago.locales.min.js"></script>
<script>
            var nodes = document.querySelectorAll('.timeago');
            var locale = nodes[0].getAttribute('locale');
            timeago.render(nodes, locale);
          </script>
</body>
</html>